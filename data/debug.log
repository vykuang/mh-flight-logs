log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-16-100-200.json
looking for /data/responses/flight-2023-09-16-500-600.json
looking for /data/responses/flight-2023-09-16-700-800.json
looking for /data/responses/flight-2023-09-16-0-100.json
looking for /data/responses/flight-2023-09-16-400-500.json
looking for /data/responses/flight-2023-09-16-300-400.json
looking for /data/responses/flight-2023-09-16-600-700.json
looking for /data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['arrival__actual_runway', 'aircraft__icao', 'departure__delay', 'arrival__gate', 'flight_date', 'departure__actual', 'arrival__iata', 'live__speed_vertical', 'arrival__scheduled', 'arrival__timezone', 'live__longitude', 'airline__icao', 'departure__scheduled', 'live__is_ground', 'departure__actual_runway', 'arrival__terminal', 'departure__gate', 'flight__number', 'flight_status', 'flight__codeshared__airline_iata', 'flight__codeshared__airline_icao', 'aircraft__iata', 'departure__estimated_runway', 'arrival__estimated_runway', 'live__latitude', 'arrival__delay', 'airline__iata', 'flight__codeshared__flight_iata', 'departure__estimated', 'departure__timezone', 'live__updated', 'arrival__icao', 'flight__iata', 'live__speed_horizontal', 'aircraft__icao24', 'flight__codeshared__flight_icao', 'aircraft__registration', 'departure__icao', 'live__direction', 'arrival__baggage', 'airline__name', 'live__altitude', 'departure__airport', 'arrival__estimated', 'flight__codeshared__airline_name', 'departure__iata', 'departure__terminal', 'arrival__actual', 'flight__codeshared__flight_number', 'flight__icao', 'arrival__airport']
connecting to sqlite db @ /data/flights.db
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-16-100-200.json
looking for /data/responses/flight-2023-09-16-500-600.json
looking for /data/responses/flight-2023-09-16-700-800.json
looking for /data/responses/flight-2023-09-16-0-100.json
looking for /data/responses/flight-2023-09-16-400-500.json
looking for /data/responses/flight-2023-09-16-300-400.json
looking for /data/responses/flight-2023-09-16-600-700.json
looking for /data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['aircraft__icao24', 'aircraft__icao', 'departure__estimated_runway', 'arrival__airport', 'live__is_ground', 'departure__delay', 'live__altitude', 'arrival__timezone', 'arrival__estimated', 'departure__actual', 'departure__terminal', 'departure__timezone', 'departure__gate', 'airline__iata', 'flight__icao', 'arrival__icao', 'flight__codeshared__flight_icao', 'arrival__baggage', 'arrival__scheduled', 'flight_date', 'live__direction', 'flight__codeshared__airline_name', 'flight__codeshared__airline_iata', 'flight__codeshared__flight_number', 'departure__icao', 'aircraft__registration', 'departure__airport', 'live__speed_horizontal', 'flight__codeshared__flight_iata', 'arrival__gate', 'airline__name', 'departure__actual_runway', 'arrival__actual', 'departure__estimated', 'arrival__iata', 'flight__number', 'flight__codeshared__airline_icao', 'live__updated', 'live__longitude', 'arrival__terminal', 'flight_status', 'airline__icao', 'arrival__actual_runway', 'flight__iata', 'aircraft__iata', 'arrival__delay', 'live__latitude', 'arrival__estimated_runway', 'live__speed_vertical', 'departure__iata', 'departure__scheduled']
connecting to sqlite db @ /data/flights.db
Use local json: True
log level: DEBUG
Use local json: False
Requesting flight API
retrieving 0th to 100th
retrieved 0th to 100th
saving to /data/responses/flight-2023-09-24-0-100.json
saved to /data/responses/flight-2023-09-24-0-100.json
Total records count: 530
retrieving 100th to 200th
retrieved 100th to 200th
saving to /data/responses/flight-2023-09-24-100-200.json
saved to /data/responses/flight-2023-09-24-100-200.json
retrieving 200th to 300th
retrieved 200th to 300th
saving to /data/responses/flight-2023-09-24-200-300.json
saved to /data/responses/flight-2023-09-24-200-300.json
retrieving 300th to 400th
retrieved 300th to 400th
saving to /data/responses/flight-2023-09-24-300-400.json
saved to /data/responses/flight-2023-09-24-300-400.json
retrieving 400th to 500th
retrieved 400th to 500th
saving to /data/responses/flight-2023-09-24-400-500.json
saved to /data/responses/flight-2023-09-24-400-500.json
retrieving 500th to 600th
retrieved 500th to 600th
saving to /data/responses/flight-2023-09-24-500-600.json
saved to /data/responses/flight-2023-09-24-500-600.json
number of fields: 51
schema:
['arrival__terminal', 'departure__estimated_runway', 'flight_date', 'flight__codeshared__flight_number', 'departure__estimated', 'departure__actual_runway', 'arrival__icao', 'departure__scheduled', 'arrival__estimated_runway', 'live__is_ground', 'arrival__delay', 'flight__iata', 'aircraft__registration', 'aircraft__iata', 'departure__gate', 'arrival__timezone', 'airline__iata', 'departure__airport', 'arrival__airport', 'departure__delay', 'flight__icao', 'flight_status', 'aircraft__icao24', 'live__speed_vertical', 'arrival__estimated', 'flight__codeshared__airline_icao', 'departure__terminal', 'live__latitude', 'aircraft__icao', 'flight__number', 'departure__timezone', 'live__longitude', 'live__direction', 'departure__actual', 'arrival__baggage', 'flight__codeshared__flight_icao', 'arrival__actual', 'live__altitude', 'arrival__scheduled', 'flight__codeshared__airline_name', 'flight__codeshared__airline_iata', 'arrival__actual_runway', 'departure__iata', 'airline__icao', 'airline__name', 'flight__codeshared__flight_iata', 'live__speed_horizontal', 'departure__icao', 'arrival__gate', 'arrival__iata', 'live__updated']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-24-300-400.json
looking for /data/responses/flight-2023-09-24-100-200.json
looking for /data/responses/flight-2023-09-24-200-300.json
looking for /data/responses/flight-2023-09-24-500-600.json
looking for /data/responses/flight-2023-09-24-400-500.json
looking for /data/responses/flight-2023-09-24-0-100.json
number of fields: 51
schema:
['departure__icao', 'departure__estimated', 'flight__icao', 'flight__codeshared__airline_name', 'departure__actual', 'aircraft__registration', 'flight_status', 'arrival__terminal', 'flight__iata', 'flight__codeshared__airline_iata', 'aircraft__icao24', 'flight__codeshared__flight_iata', 'departure__iata', 'arrival__baggage', 'live__altitude', 'departure__delay', 'departure__airport', 'arrival__icao', 'aircraft__icao', 'arrival__timezone', 'live__longitude', 'arrival__estimated', 'arrival__airport', 'airline__icao', 'arrival__delay', 'live__speed_vertical', 'arrival__estimated_runway', 'airline__name', 'arrival__scheduled', 'departure__scheduled', 'live__is_ground', 'departure__estimated_runway', 'live__latitude', 'departure__actual_runway', 'departure__timezone', 'flight__number', 'live__updated', 'live__speed_horizontal', 'departure__terminal', 'aircraft__iata', 'flight__codeshared__flight_number', 'arrival__iata', 'flight__codeshared__flight_icao', 'live__direction', 'arrival__gate', 'flight__codeshared__airline_icao', 'airline__iata', 'arrival__actual_runway', 'departure__gate', 'arrival__actual', 'flight_date']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
530 entries UPSERTed into database
Querying database...
DB query executed
tweet length: 218
link: https://twitter.com/user/status/1706499145513721932
text: 297 MH flights were late on 2023-09-24 by an average of 23 min. Most delayed
MH9663: Chicago O'hare -&gt; Los Angeles, 197 min
MH9506: Dallas/Fort Worth -&gt; John F Kennedy, 134 min
MH9110: Haneda -&gt; Chicago O'hare, 131 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-24-300-400.json
looking for /data/responses/flight-2023-09-24-100-200.json
looking for /data/responses/flight-2023-09-24-200-300.json
looking for /data/responses/flight-2023-09-24-500-600.json
looking for /data/responses/flight-2023-09-24-400-500.json
looking for /data/responses/flight-2023-09-24-0-100.json
number of fields: 51
schema:
['flight_date', 'departure__estimated', 'arrival__icao', 'arrival__terminal', 'flight__codeshared__flight_icao', 'departure__actual_runway', 'aircraft__iata', 'arrival__baggage', 'departure__iata', 'departure__gate', 'arrival__delay', 'departure__actual', 'live__speed_vertical', 'live__altitude', 'live__updated', 'departure__icao', 'flight__codeshared__airline_iata', 'aircraft__icao', 'airline__name', 'airline__iata', 'flight_status', 'departure__terminal', 'arrival__iata', 'departure__delay', 'arrival__estimated', 'flight__number', 'flight__codeshared__flight_iata', 'aircraft__icao24', 'departure__scheduled', 'flight__codeshared__airline_name', 'airline__icao', 'live__longitude', 'arrival__estimated_runway', 'arrival__actual_runway', 'flight__iata', 'flight__icao', 'flight__codeshared__flight_number', 'departure__estimated_runway', 'aircraft__registration', 'live__latitude', 'departure__timezone', 'arrival__airport', 'live__direction', 'arrival__gate', 'live__is_ground', 'departure__airport', 'arrival__timezone', 'arrival__scheduled', 'arrival__actual', 'flight__codeshared__airline_icao', 'live__speed_horizontal']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
530 entries UPSERTed into database
Querying database...
DB query executed
tweet length: 218
offline tweet:
297 MH flights were late on 2023-09-24 by an average of 23 min. Most delayed
MH9663: Chicago O'hare -> Los Angeles, 197 min
MH9506: Dallas/Fort Worth -> John F Kennedy, 134 min
MH9110: Haneda -> Chicago O'hare, 131 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-24-300-400.json
looking for /data/responses/flight-2023-09-24-100-200.json
looking for /data/responses/flight-2023-09-24-200-300.json
looking for /data/responses/flight-2023-09-24-500-600.json
looking for /data/responses/flight-2023-09-24-400-500.json
looking for /data/responses/flight-2023-09-24-0-100.json
number of fields: 51
schema:
['aircraft__registration', 'live__direction', 'arrival__estimated_runway', 'live__is_ground', 'arrival__terminal', 'airline__name', 'flight_date', 'arrival__estimated', 'departure__actual_runway', 'aircraft__icao', 'arrival__gate', 'arrival__delay', 'airline__iata', 'flight__codeshared__airline_icao', 'departure__delay', 'departure__gate', 'flight__codeshared__flight_icao', 'airline__icao', 'flight_status', 'aircraft__iata', 'live__altitude', 'arrival__scheduled', 'departure__estimated_runway', 'departure__actual', 'flight__codeshared__airline_name', 'departure__icao', 'flight__icao', 'departure__scheduled', 'live__speed_horizontal', 'arrival__baggage', 'live__updated', 'arrival__actual', 'arrival__actual_runway', 'live__latitude', 'departure__iata', 'flight__codeshared__flight_number', 'arrival__iata', 'departure__estimated', 'flight__number', 'flight__iata', 'departure__airport', 'aircraft__icao24', 'live__speed_vertical', 'flight__codeshared__airline_iata', 'departure__terminal', 'live__longitude', 'departure__timezone', 'arrival__airport', 'flight__codeshared__flight_iata', 'arrival__timezone', 'arrival__icao']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
530 entries UPSERTed into database
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-24-300-400.json
looking for /data/responses/flight-2023-09-24-100-200.json
looking for /data/responses/flight-2023-09-24-200-300.json
looking for /data/responses/flight-2023-09-24-500-600.json
looking for /data/responses/flight-2023-09-24-400-500.json
looking for /data/responses/flight-2023-09-24-0-100.json
number of fields: 51
schema:
['departure__estimated', 'departure__scheduled', 'flight__icao', 'aircraft__icao24', 'departure__icao', 'arrival__delay', 'flight__codeshared__flight_number', 'arrival__terminal', 'flight__codeshared__airline_icao', 'flight_status', 'departure__actual_runway', 'flight__codeshared__airline_name', 'live__speed_vertical', 'departure__timezone', 'live__altitude', 'arrival__estimated_runway', 'arrival__gate', 'arrival__icao', 'live__speed_horizontal', 'arrival__actual', 'arrival__actual_runway', 'departure__terminal', 'live__updated', 'flight__codeshared__flight_iata', 'aircraft__registration', 'live__direction', 'airline__name', 'flight__codeshared__flight_icao', 'live__latitude', 'arrival__baggage', 'flight_date', 'flight__iata', 'airline__iata', 'departure__airport', 'arrival__timezone', 'arrival__iata', 'flight__codeshared__airline_iata', 'departure__iata', 'departure__actual', 'arrival__airport', 'arrival__scheduled', 'aircraft__iata', 'airline__icao', 'flight__number', 'live__is_ground', 'departure__estimated_runway', 'arrival__estimated', 'live__longitude', 'departure__gate', 'departure__delay', 'aircraft__icao']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
530 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /app/templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-24';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-24'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 218
offline tweet:
297 MH flights were late on 2023-09-24 by an average of 23 min. Most delayed
MH9663: Chicago O'hare to Los Angeles, 197 min
MH9506: Dallas/Fort Worth to John F Kennedy, 134 min
MH9110: Haneda to Chicago O'hare, 131 min
log level: DEBUG
Use local json: True
looking for data/responses/flight-2023-09-16-100-200.json
looking for data/responses/flight-2023-09-16-500-600.json
looking for data/responses/flight-2023-09-16-700-800.json
looking for data/responses/flight-2023-09-16-0-100.json
looking for data/responses/flight-2023-09-16-400-500.json
looking for data/responses/flight-2023-09-16-300-400.json
looking for data/responses/flight-2023-09-16-600-700.json
looking for data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['flight__icao', 'departure__airport', 'departure__estimated_runway', 'arrival__actual_runway', 'aircraft__icao', 'live__latitude', 'flight__codeshared__flight_iata', 'departure__delay', 'live__direction', 'departure__scheduled', 'arrival__scheduled', 'arrival__delay', 'flight__iata', 'live__speed_vertical', 'live__is_ground', 'arrival__actual', 'arrival__icao', 'flight__codeshared__flight_icao', 'departure__actual_runway', 'airline__iata', 'airline__name', 'departure__terminal', 'live__longitude', 'arrival__airport', 'live__updated', 'flight__number', 'departure__actual', 'arrival__gate', 'arrival__estimated_runway', 'flight__codeshared__airline_icao', 'arrival__iata', 'departure__icao', 'arrival__timezone', 'departure__gate', 'flight__codeshared__flight_number', 'departure__iata', 'flight_date', 'flight__codeshared__airline_name', 'arrival__baggage', 'airline__icao', 'live__altitude', 'aircraft__registration', 'live__speed_horizontal', 'arrival__estimated', 'departure__estimated', 'arrival__terminal', 'aircraft__icao24', 'flight__codeshared__airline_iata', 'departure__timezone', 'aircraft__iata', 'flight_status']
connecting to sqlite db @ data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
714 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /app/templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-16';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-16'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 213
offline tweet:
244 MH flights were late on 2023-09-16 by an average of 19 min. Most delayed
MH88: Kuala Lumpur (klia) to Narita, 142 min
MH133: Kuala Lumpur (klia) to Auckland, 126 min
MH9210: Hong Kong to John F Kennedy, 91 min
log level: DEBUG
Use local json: True
looking for data/responses/flight-2023-09-16-100-200.json
looking for data/responses/flight-2023-09-16-500-600.json
looking for data/responses/flight-2023-09-16-700-800.json
looking for data/responses/flight-2023-09-16-0-100.json
looking for data/responses/flight-2023-09-16-400-500.json
looking for data/responses/flight-2023-09-16-300-400.json
looking for data/responses/flight-2023-09-16-600-700.json
looking for data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['aircraft__registration', 'live__latitude', 'flight__number', 'live__direction', 'arrival__icao', 'flight__iata', 'airline__iata', 'departure__icao', 'arrival__estimated_runway', 'arrival__delay', 'departure__actual_runway', 'departure__terminal', 'flight__codeshared__flight_icao', 'departure__scheduled', 'departure__gate', 'live__updated', 'arrival__airport', 'arrival__terminal', 'flight__codeshared__flight_number', 'live__longitude', 'arrival__actual', 'flight__codeshared__airline_name', 'airline__icao', 'departure__delay', 'flight_status', 'arrival__gate', 'departure__estimated', 'departure__iata', 'airline__name', 'flight_date', 'departure__timezone', 'departure__actual', 'flight__codeshared__airline_iata', 'flight__codeshared__airline_icao', 'arrival__scheduled', 'arrival__baggage', 'aircraft__icao', 'departure__airport', 'arrival__estimated', 'aircraft__icao24', 'arrival__actual_runway', 'departure__estimated_runway', 'flight__icao', 'live__altitude', 'live__speed_horizontal', 'flight__codeshared__flight_iata', 'arrival__iata', 'aircraft__iata', 'live__speed_vertical', 'arrival__timezone', 'live__is_ground']
connecting to sqlite db @ data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
714 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /app/templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-16';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-16'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 213
offline tweet:
244 MH flights were late on 2023-09-16 by an average of 19 min. Most delayed
MH88: Kuala Lumpur (klia) to Narita, 142 min
MH133: Kuala Lumpur (klia) to Auckland, 126 min
MH9210: Hong Kong to John F Kennedy, 91 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-16-100-200.json
looking for /data/responses/flight-2023-09-16-500-600.json
looking for /data/responses/flight-2023-09-16-700-800.json
looking for /data/responses/flight-2023-09-16-0-100.json
looking for /data/responses/flight-2023-09-16-400-500.json
looking for /data/responses/flight-2023-09-16-300-400.json
looking for /data/responses/flight-2023-09-16-600-700.json
looking for /data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['arrival__icao', 'arrival__baggage', 'arrival__gate', 'arrival__timezone', 'arrival__actual_runway', 'flight_status', 'live__direction', 'departure__estimated', 'aircraft__icao24', 'aircraft__icao', 'departure__iata', 'aircraft__iata', 'aircraft__registration', 'departure__terminal', 'departure__timezone', 'flight__number', 'live__speed_vertical', 'flight__codeshared__flight_icao', 'arrival__scheduled', 'arrival__estimated_runway', 'arrival__estimated', 'airline__icao', 'airline__iata', 'live__latitude', 'flight__icao', 'arrival__terminal', 'departure__actual_runway', 'airline__name', 'live__longitude', 'live__speed_horizontal', 'flight__codeshared__airline_iata', 'flight__codeshared__flight_number', 'departure__gate', 'arrival__airport', 'flight__codeshared__airline_name', 'live__is_ground', 'departure__scheduled', 'departure__icao', 'arrival__actual', 'flight__codeshared__airline_icao', 'arrival__delay', 'flight__iata', 'departure__actual', 'flight__codeshared__flight_iata', 'departure__airport', 'live__updated', 'live__altitude', 'departure__estimated_runway', 'flight_date', 'arrival__iata', 'departure__delay']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
714 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-16';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-16'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 213
offline tweet:
244 MH flights were late on 2023-09-16 by an average of 19 min. Most delayed
MH88: Kuala Lumpur (klia) to Narita, 142 min
MH133: Kuala Lumpur (klia) to Auckland, 126 min
MH9210: Hong Kong to John F Kennedy, 91 min
Use local json: False
Requesting flight API
retrieving 0th to 100th
saving to /data/responses/flight-2023-09-26-0-100.json
Total records count: 489
retrieving 100th to 200th
saving to /data/responses/flight-2023-09-26-100-200.json
retrieving 200th to 300th
saving to /data/responses/flight-2023-09-26-200-300.json
retrieving 300th to 400th
saving to /data/responses/flight-2023-09-26-300-400.json
retrieving 400th to 500th
saving to /data/responses/flight-2023-09-26-400-500.json
489 entries UPSERTed into database
DB query executed
link: https://twitter.com/user/status/1706856620674994298
text: 442 MH flights were late on 2023-09-26 by an average of 23 min. Most delayed
MH9785: Arturo Merino Benitez to Melbourne - Tullamarine, 878 min
MH9784: Melbourne - Tullamarine to Arturo Merino Benitez, 550 min
MH126: Perth to Kuala Lumpur (klia), 193 min
Use local json: False
Requesting flight API
retrieving 0th to 100th
saving to /data/responses/flight-2023-09-26-0-100.json
Total records count: 491
retrieving 100th to 200th
saving to /data/responses/flight-2023-09-26-100-200.json
retrieving 200th to 300th
saving to /data/responses/flight-2023-09-26-200-300.json
retrieving 300th to 400th
saving to /data/responses/flight-2023-09-26-300-400.json
retrieving 400th to 500th
saving to /data/responses/flight-2023-09-26-400-500.json
491 entries UPSERTed into database
DB query executed
link: https://twitter.com/user/status/1706857979411365985
text: 443 MH flights were late on 2023-09-26 by an average of 23 min. 
1 MH9785: Arturo Merino Benitez to Melbourne - Tullamarine, 878 min
2 MH9784: Melbourne - Tullamarine to Arturo Merino Benitez, 550 min
3 MH126: Perth to Kuala Lumpur (klia), 193 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-26-400-500.json
looking for /data/responses/flight-2023-09-26-100-200.json
looking for /data/responses/flight-2023-09-26-0-100.json
looking for /data/responses/flight-2023-09-26-200-300.json
looking for /data/responses/flight-2023-09-26-300-400.json
number of fields: 51
schema:
['live__speed_vertical', 'airline__icao', 'live__longitude', 'flight__number', 'aircraft__icao24', 'flight__codeshared__flight_iata', 'aircraft__iata', 'departure__actual', 'departure__icao', 'departure__gate', 'departure__estimated', 'arrival__actual_runway', 'arrival__actual', 'flight__iata', 'departure__delay', 'arrival__estimated_runway', 'flight__codeshared__flight_number', 'flight__codeshared__airline_icao', 'departure__terminal', 'live__direction', 'arrival__icao', 'arrival__airport', 'flight_status', 'arrival__estimated', 'arrival__scheduled', 'arrival__iata', 'airline__name', 'arrival__gate', 'arrival__baggage', 'departure__timezone', 'flight__codeshared__airline_iata', 'flight__codeshared__flight_icao', 'live__speed_horizontal', 'departure__actual_runway', 'airline__iata', 'live__updated', 'arrival__terminal', 'live__altitude', 'departure__estimated_runway', 'live__is_ground', 'departure__iata', 'flight__codeshared__airline_name', 'aircraft__icao', 'arrival__delay', 'flight_date', 'flight__icao', 'arrival__timezone', 'departure__airport', 'departure__scheduled', 'aircraft__registration', 'live__latitude']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
491 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-26';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-26'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 247
offline tweet:
443 MH flights were late on 2023-09-26 by an average of 23 min. 
1 MH9785: Arturo Merino Benitez to Melbourne - Tullamarine, 878 min
2 MH9784: Melbourne - Tullamarine to Arturo Merino Benitez, 550 min
3 MH126: Perth to Kuala Lumpur (klia), 193 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-26-400-500.json
looking for /data/responses/flight-2023-09-26-100-200.json
looking for /data/responses/flight-2023-09-26-0-100.json
looking for /data/responses/flight-2023-09-26-200-300.json
looking for /data/responses/flight-2023-09-26-300-400.json
number of fields: 51
schema:
['departure__iata', 'arrival__actual', 'airline__icao', 'departure__airport', 'departure__delay', 'arrival__iata', 'live__speed_horizontal', 'live__is_ground', 'flight__codeshared__flight_iata', 'flight__icao', 'aircraft__icao', 'airline__iata', 'live__longitude', 'live__speed_vertical', 'departure__timezone', 'flight__codeshared__flight_icao', 'departure__scheduled', 'arrival__delay', 'departure__gate', 'aircraft__icao24', 'live__direction', 'arrival__scheduled', 'flight__iata', 'arrival__estimated_runway', 'flight__number', 'flight__codeshared__airline_icao', 'departure__actual', 'flight_status', 'departure__estimated_runway', 'arrival__airport', 'airline__name', 'live__altitude', 'arrival__baggage', 'live__updated', 'arrival__gate', 'arrival__timezone', 'flight__codeshared__flight_number', 'arrival__estimated', 'departure__icao', 'aircraft__iata', 'flight_date', 'live__latitude', 'departure__terminal', 'departure__estimated', 'flight__codeshared__airline_iata', 'flight__codeshared__airline_name', 'arrival__icao', 'departure__actual_runway', 'aircraft__registration', 'arrival__terminal', 'arrival__actual_runway']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
491 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-26';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-26'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 247
offline tweet:
443 MH flights were late on 2023-09-26 by an average of 23 min. 
1 MH9785: Arturo Merino Benitez to Melbourne - Tullamarine, 878 min
2 MH9784: Melbourne - Tullamarine to Arturo Merino Benitez, 550 min
3 MH126: Perth to Kuala Lumpur (klia), 193 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-26-400-500.json
looking for /data/responses/flight-2023-09-26-100-200.json
looking for /data/responses/flight-2023-09-26-0-100.json
looking for /data/responses/flight-2023-09-26-200-300.json
looking for /data/responses/flight-2023-09-26-300-400.json
number of fields: 51
schema:
['airline__iata', 'arrival__delay', 'arrival__gate', 'departure__terminal', 'aircraft__registration', 'arrival__baggage', 'flight__codeshared__airline_icao', 'flight__icao', 'aircraft__icao', 'departure__estimated_runway', 'arrival__scheduled', 'departure__actual_runway', 'arrival__estimated_runway', 'flight__number', 'flight__codeshared__flight_number', 'flight__codeshared__airline_name', 'live__altitude', 'departure__scheduled', 'arrival__iata', 'departure__airport', 'aircraft__iata', 'arrival__estimated', 'flight_date', 'arrival__actual_runway', 'flight__codeshared__airline_iata', 'live__speed_horizontal', 'flight_status', 'live__latitude', 'departure__iata', 'departure__delay', 'arrival__icao', 'airline__icao', 'departure__icao', 'arrival__actual', 'departure__timezone', 'live__direction', 'live__longitude', 'aircraft__icao24', 'departure__actual', 'flight__codeshared__flight_iata', 'arrival__terminal', 'arrival__airport', 'flight__iata', 'flight__codeshared__flight_icao', 'live__speed_vertical', 'live__updated', 'departure__estimated', 'live__is_ground', 'airline__name', 'arrival__timezone', 'departure__gate']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
491 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-26';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-26'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 247
offline tweet:
443 MH flights were late on 2023-09-26 by an average of 23 min. 
1 MH9785: Arturo Merino Benitez to Melbourne - Tullamarine, 878 min
2 MH9784: Melbourne - Tullamarine to Arturo Merino Benitez, 550 min
3 MH126: Perth to Kuala Lumpur (klia), 193 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-16-100-200.json
looking for /data/responses/flight-2023-09-16-500-600.json
looking for /data/responses/flight-2023-09-16-700-800.json
looking for /data/responses/flight-2023-09-16-0-100.json
looking for /data/responses/flight-2023-09-16-400-500.json
looking for /data/responses/flight-2023-09-16-300-400.json
looking for /data/responses/flight-2023-09-16-600-700.json
looking for /data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['live__updated', 'flight__codeshared__airline_iata', 'flight__codeshared__flight_iata', 'flight__codeshared__airline_icao', 'flight__iata', 'aircraft__registration', 'airline__iata', 'arrival__timezone', 'arrival__estimated_runway', 'airline__icao', 'flight__number', 'departure__estimated_runway', 'flight__icao', 'aircraft__icao', 'arrival__icao', 'departure__estimated', 'arrival__scheduled', 'flight__codeshared__flight_number', 'live__direction', 'arrival__baggage', 'flight__codeshared__flight_icao', 'flight_status', 'aircraft__icao24', 'airline__name', 'arrival__actual', 'departure__actual', 'live__speed_horizontal', 'departure__actual_runway', 'arrival__airport', 'arrival__actual_runway', 'arrival__iata', 'live__altitude', 'live__speed_vertical', 'live__is_ground', 'departure__iata', 'aircraft__iata', 'departure__icao', 'departure__airport', 'arrival__estimated', 'flight__codeshared__airline_name', 'departure__terminal', 'departure__delay', 'departure__scheduled', 'arrival__gate', 'live__latitude', 'arrival__delay', 'flight_date', 'live__longitude', 'departure__timezone', 'departure__gate', 'arrival__terminal']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
714 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-16';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-16'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 207
offline tweet:
244 MH flights were late on 2023-09-16 by an average of 19 min. 
1 MH88: Kuala Lumpur (klia) to Narita, 142 min
2 MH133: Kuala Lumpur (klia) to Auckland, 126 min
3 MH9210: Hong Kong to John F Kennedy, 91 min
log level: DEBUG
Use local json: True
looking for /data/responses/flight-2023-09-16-100-200.json
looking for /data/responses/flight-2023-09-16-500-600.json
looking for /data/responses/flight-2023-09-16-700-800.json
looking for /data/responses/flight-2023-09-16-0-100.json
looking for /data/responses/flight-2023-09-16-400-500.json
looking for /data/responses/flight-2023-09-16-300-400.json
looking for /data/responses/flight-2023-09-16-600-700.json
looking for /data/responses/flight-2023-09-16-200-300.json
number of fields: 51
schema:
['airline__icao', 'departure__iata', 'flight__codeshared__flight_number', 'arrival__gate', 'flight__number', 'live__updated', 'arrival__scheduled', 'departure__scheduled', 'departure__estimated', 'flight__icao', 'live__direction', 'aircraft__iata', 'departure__delay', 'live__latitude', 'arrival__actual', 'departure__airport', 'arrival__icao', 'flight__codeshared__airline_icao', 'live__altitude', 'live__speed_horizontal', 'airline__name', 'departure__terminal', 'arrival__terminal', 'flight__codeshared__airline_iata', 'departure__gate', 'departure__actual', 'flight__iata', 'flight__codeshared__flight_icao', 'arrival__timezone', 'arrival__estimated', 'aircraft__registration', 'arrival__estimated_runway', 'flight_status', 'arrival__delay', 'flight__codeshared__flight_iata', 'live__is_ground', 'departure__timezone', 'live__longitude', 'departure__icao', 'arrival__iata', 'airline__iata', 'aircraft__icao24', 'flight__codeshared__airline_name', 'arrival__baggage', 'departure__estimated_runway', 'arrival__actual_runway', 'flight_date', 'aircraft__icao', 'departure__actual_runway', 'arrival__airport', 'live__speed_vertical']
connecting to sqlite db @ /data/flights.db
Executing DDL
DDL executed
51 columns retrieved from tbl_info
714 entries UPSERTed into database
Instantiating jinja environment
Searching for sql templates from /templates
rendered agg_sql:
SELECT 
    COUNT(*) num_delayed,
    AVG(arrival__delay) avg_delay
FROM import_flight_records
WHERE DATE(arrival__scheduled) = '2023-09-16';
rendered delayed_sql:
SELECT 
            ROW_NUMBER() OVER (ORDER BY CAST(arrival__delay AS INTEGER) DESC) delay_rank,
            flight__iata,
            REPLACE(
            REPLACE(
            REPLACE(arrival__airport, ' International Airport', ''), 
            ' International', ''),
            ' Airport', '') AS arrival__airport,
            REPLACE(
            REPLACE(
            REPLACE(departure__airport, ' International Airport', ''),
            ' International', ''),
            ' Airport', '') AS departure__airport,
            arrival__delay
        FROM import_flight_records
        WHERE DATE(arrival__scheduled) = '2023-09-16'
        ORDER BY delay_rank
        LIMIT 3;
Querying database...
DB query executed
tweet length: 207
offline tweet:
244 MH flights were late on 2023-09-16 by an average of 19 min. 
1 MH88: Kuala Lumpur (klia) to Narita, 142 min
2 MH133: Kuala Lumpur (klia) to Auckland, 126 min
3 MH9210: Hong Kong to John F Kennedy, 91 min
